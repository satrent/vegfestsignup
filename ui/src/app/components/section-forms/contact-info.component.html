<div class="section-container">
    <h2>Section 1 â€” Basics</h2>
    @if (form.disabled) {
    <div class="alert alert-warning">
        This application has been submitted and is currently locked.
    </div>
    } @else {
    <div class="alert alert-info">
        Please verify and complete your contact information.
    </div>
    }

    <form [formGroup]="form" (ngSubmit)="onSubmit()">

        <!-- Contact Name -->
        <div class="row">
            <div class="form-group half">
                <label for="firstName">Contact Name (First)<span class="required">*</span></label>
                <input id="firstName" type="text" formControlName="firstName" placeholder="First Name">
                @if (form.get('firstName')?.touched && form.get('firstName')?.invalid) {
                <div class="error">First name is required</div>
                }
            </div>
            <div class="form-group half">
                <label for="lastName">Contact Name (Last)<span class="required">*</span></label>
                <input id="lastName" type="text" formControlName="lastName" placeholder="Last Name">
                @if (form.get('lastName')?.touched && form.get('lastName')?.invalid) {
                <div class="error">Last name is required</div>
                }
            </div>
        </div>

        <!-- Want Booth? -->
        <div class="form-group">
            <label>Do you want to have a booth at the festival?<span class="required">*</span></label>
            <div class="radio-group">
                <label class="radio-item">
                    <input type="radio" [value]="true" formControlName="wantBooth">
                    <span>Yes</span>
                </label>
                <label class="radio-item">
                    <input type="radio" [value]="false" formControlName="wantBooth">
                    <span>No</span>
                </label>
            </div>
            @if (form.get('wantBooth')?.touched && form.get('wantBooth')?.invalid) {
            <div class="error">Please select an option</div>
            }
        </div>


        <!-- On Site -->
        <div class="form-group">
            <label>Will you be on site on the day of the festival?<span class="required">*</span></label>
            <div class="radio-group">
                <!-- Using inline radio group style but with new label structure -->
                <label class="radio-item">
                    <input type="radio" value="yes" formControlName="onSite">
                    <span>Yes</span>
                </label>
                <label class="radio-item">
                    <input type="radio" value="no" formControlName="onSite">
                    <span>No</span>
                </label>
                <label class="radio-item">
                    <input type="radio" value="unsure" formControlName="onSite">
                    <span>Unsure</span>
                </label>
            </div>
        </div>

        <!-- On Site Contact (Conditional) -->
        @if (form.get('onSite')?.value === 'no' || form.get('onSite')?.value === 'unsure') {
        <div class="section-box" formGroupName="onSiteContact">
            <p>If no or unsure, we will want an on-site contact by August 31.</p>
            <div class="row">
                <div class="form-group half">
                    <label>On site first name</label>
                    <input type="text" formControlName="firstName">
                </div>
                <div class="form-group half">
                    <label>On site last name</label>
                    <input type="text" formControlName="lastName">
                </div>
            </div>
            <div class="row">
                <div class="form-group half">
                    <label>On site phone</label>
                    <input type="text" formControlName="phone">
                    @if (form.get('onSiteContact.phone')?.touched &&
                    form.get('onSiteContact.phone')?.errors?.['pattern']) {
                    <div class="error">Phone number must be 10 digits</div>
                    }
                </div>
                <div class="form-group half">
                    <label>On site email</label>
                    <input type="email" formControlName="email">
                </div>
            </div>
            @if (form.errors?.['onSiteContactRequired']) {
            <div class="error">All on-site contact fields are required if you are not on site.</div>
            }
        </div>
        }

        <!-- Org/Brand -->
        <div class="form-group">
            <label for="orgName">Organization/brand name<span class="required">*</span></label>
            <input id="orgName" type="text" formControlName="organizationName">
        </div>

        <!-- Established -->
        <div class="form-group">
            <label for="establishedDate">What month and year was your business established?</label>
            <input id="establishedDate" type="text" formControlName="establishedDate" placeholder="e.g. May 2020">
        </div>

        <!-- Email & Phone -->
        <div class="row">
            <div class="form-group half">
                <label for="email">Email<span class="required">*</span></label>
                <input id="email" type="email" formControlName="email">
            </div>
            <div class="form-group half">
                <label for="phone">Mobile phone<span class="required">*</span></label>
                <input id="phone" type="tel" formControlName="phone">
                @if (form.get('phone')?.touched && form.get('phone')?.errors?.['pattern']) {
                <div class="error">Phone number must be 10 digits (###-###-####)</div>
                }
            </div>
        </div>

        <!-- Website/Socials -->
        <h3>Website or social (URL and/or @handle) [One Required]</h3>
        <div class="form-group">
            <label>Website</label>
            <input type="text" formControlName="website" placeholder="https://...">
        </div>
        <div class="form-group">
            <label>Instagram</label>
            <div class="input-group-handle">
                <span class="prefix">@</span>
                <input type="text" formControlName="instagram" placeholder="handle">
            </div>
            <small class="hint">We'll automatically remove the URL if you paste one.</small>
        </div>
        <div class="form-group">
            <label>Facebook</label>
            <div class="input-group-handle">
                <span class="prefix">@</span>
                <input type="text" formControlName="facebook" placeholder="username">
            </div>
        </div>
        @if (form.errors?.['websiteOrSocialRequired'] && (form.touched || form.dirty)) {
        <div class="error">At least one website or social media link is required.</div>
        }

        <!-- Address -->
        <div class="form-group">
            <label>Street address<span class="required">*</span></label>
            <input type="text" formControlName="address">
        </div>
        <div class="row">
            <div class="form-group third">
                <label>City<span class="required">*</span></label>
                <input type="text" formControlName="city">
            </div>
            <div class="form-group third">
                <label>State<span class="required">*</span></label>
                <input type="text" formControlName="state">
            </div>
            <div class="form-group third">
                <label>ZIP<span class="required">*</span></label>
                <input type="text" formControlName="zip">
            </div>
        </div>

        <!-- History -->
        <div class="form-group">
            <label>Have you participated in Twin Cities Veg Fest before? [Yes/No]<span class="required">*</span></label>
            <div class="radio-group">
                <label class="radio-item">
                    <input type="radio" [value]="true" formControlName="participatedBefore">
                    <span>Yes</span>
                </label>
                <label class="radio-item">
                    <input type="radio" [value]="false" formControlName="participatedBefore">
                    <span>No</span>
                </label>
            </div>
        </div>

        @if (form.get('participatedBefore')?.value === false) {
        <div class="form-group">
            <label>Have you sold products at other events or festivals?</label>
            <input type="text" formControlName="soldElsewhere">
        </div>
        }

        @if (!isSponsor) {
        <!-- Demographics -->
        <div class="form-group">
            <label>We want to showcase food and products from a wide range of cultures at the festival. Please share the
                owner(s) races or ethnicities (check all that apply):</label>
            <select multiple formControlName="ownerDemographics" class="multi-select">
                <option value="African or Black">African or Black</option>
                <option value="Asian">Asian</option>
                <option value="Hispanic/Latinx">Hispanic/Latinx</option>
                <option value="Indigenous">Indigenous</option>
                <option value="White">White</option>
                <option value="Other">Other</option>
            </select>
            <small>(Hold Ctrl/Cmd to select multiple)</small>
        </div>

        <!-- Vegan Checks -->
        <div class="form-group">
            <label>We are a vegan festival. Please check all that apply to your business when not at Twin Cities Veg
                Fest:</label>
            <div class="radio-list">
                <label class="radio-item">
                    <input type="checkbox" formControlName="isVeganOwners">
                    <span>The owners of this business or organization are vegan</span>
                </label>
                <label class="radio-item">
                    <input type="checkbox" formControlName="isVeganProducts">
                    <span>All products sold by the business or organization are vegan</span>
                </label>
            </div>
        </div>
        }

        <!-- Sponsorship Section -->
        @if (isSponsor) {
        <div class="sponsorship-section">
            <h3>Sponsorship Level</h3>

            <div class="form-group">
                <label>Have you sponsored the festival in the past?<span class="required">*</span></label>
                <div class="radio-group">
                    <label class="radio-item">
                        <input type="radio" [value]="true" formControlName="sponsoredBefore">
                        <span>Yes</span>
                    </label>
                    <label class="radio-item">
                        <input type="radio" [value]="false" formControlName="sponsoredBefore">
                        <span>No</span>
                    </label>
                </div>
            </div>

            <p class="description">Sponsor level-prices good through Feb 20.</p>
            <div class="form-group">
                <label>Select Sponsorship Level<span class="required">*</span></label>
                <div class="radio-list">
                    <label class="radio-item">
                        <input type="radio" value="product" formControlName="sponsorshipLevel">
                        <span>Product - provide 300 free product coupons or products</span>
                    </label>
                    <label class="radio-item">
                        <input type="radio" value="bronze" formControlName="sponsorshipLevel">
                        <span>Bronze - {{ form.get('sponsoredBefore')?.value ? '$600' : '$1,000' }}</span>
                    </label>
                    <label class="radio-item">
                        <input type="radio" value="silver" formControlName="sponsorshipLevel">
                        <span>Silver - {{ form.get('sponsoredBefore')?.value ? '$2,000' : '$3,000' }}</span>
                    </label>
                    <label class="radio-item">
                        <input type="radio" value="gold" formControlName="sponsorshipLevel">
                        <span>Gold - {{ form.get('sponsoredBefore')?.value ? '$4,500' : '$6,000' }}</span>
                    </label>
                    <label class="radio-item">
                        <input type="radio" value="platinum" formControlName="sponsorshipLevel">
                        <span>Platinum - {{ form.get('sponsoredBefore')?.value ? '$10,000' : '$15,000' }}</span>
                    </label>
                    <label class="radio-item">
                        <input type="radio" value="presenting" formControlName="sponsorshipLevel">
                        <span>Presenting - {{ form.get('sponsoredBefore')?.value ? '$25,000' : '$30,000' }}</span>
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label>Do you want to distribute 300 free product coupons or free products in our swag bags?<span
                        class="required">*</span></label>
                <div class="radio-group" style="display: flex; gap: 20px;">
                    <label class="radio-item">
                        <input type="radio" [value]="true" formControlName="swagBagParticipation">
                        <span>Yes</span>
                    </label>
                    <label class="radio-item">
                        <input type="radio" [value]="false" formControlName="swagBagParticipation">
                        <span>No</span>
                    </label>
                </div>
            </div>

            @if (form.get('swagBagParticipation')?.value === true) {
            <div class="swag-details">
                <div class="form-group">
                    <label>Are you interested in distributing coupons or products?<span
                            class="required">*</span></label>
                    <div class="radio-group" style="display: flex; gap: 20px;">
                        <label class="radio-item">
                            <input type="radio" value="coupons" formControlName="swagDistributionInterest">
                            <span>Coupons</span>
                        </label>
                        <label class="radio-item">
                            <input type="radio" value="products" formControlName="swagDistributionInterest">
                            <span>Products</span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label>What product or product coupon do you want to provide?<span class="required">*</span></label>
                    <input type="text" formControlName="swagDistributionItem" placeholder="Describe the item or coupon">
                </div>

                @if (form.get('swagDistributionInterest')?.value === 'products') {
                <div class="form-group">
                    <label class="checkbox-container">
                        <input type="checkbox" formControlName="palletsDonation">
                        <span class="label-text"><strong>Pallets:</strong> We can accept donations of up to one pallet
                            of packaged snacks. Please check here if you would like to donate a pallet shipment.</span>
                    </label>
                </div>

                @if (form.get('palletsDonation')?.value === true) {
                <div class="alert alert-info">
                    <strong>Shipping:</strong> products or coupons should be delivered the week of September 1<br>
                    Our shipping address is:<br>
                    Compassionate Action for Animals<br>
                    34 13th Avenue NE<br>
                    Suite 108<br>
                    Minneapolis, MN 55413
                </div>
                }
                }
            </div>
            }

            @if (form.get('sponsorshipLevel')?.value === 'product') {
            <small class="hint">Included with Product Sponsorship.</small>
            }
        </div>
        }

        <div class="actions">
            <button type="button" class="secondary" (click)="cancel()">Cancel</button>
            <button type="submit" [disabled]="form.invalid || saving">
                {{ saving ? 'Saving...' : 'Save & Complete Section' }}
            </button>
        </div>
    </form>
</div>