<div class="section-container">
    <div class="section-header">
        <h2>Payment & Fees</h2>
        <p>Please review your fees below. Secure payment is handled by Stripe.</p>
    </div>

    <div class="loading-spinner" *ngIf="loading">
        Loading...
    </div>

    <div class="content-wrapper" *ngIf="!loading">

        <div class="fee-summary">
            <h3>Fee Summary</h3>

            <div class="fee-row">
                <span class="label">Application Fee (Due Now)</span>
                <span class="amount">{{ totalDue | currency }}</span>
            </div>
            <div class="fee-note">
                * This non-refundable application fee is applied towards your total balance.
                <br>
                * Remaining balance (Exhibitor Fee + Security Deposit - App Fee) will be due upon approval.
            </div>

            <div class="total-row">
                <span class="label">Total Due Now</span>
                <span class="amount">{{ totalDue | currency }}</span>
            </div>
        </div>



        <div class="error-message" *ngIf="error">
            {{ error }}
        </div>

        <!-- Stripe Payment Element -->
        <div class="stripe-container" *ngIf="!registration?.sectionStatus?.payment && elementsOptions.clientSecret">


            <p class="crypto-notice">
                <span class="material-icons">lock</span>
                Secure Payment via Stripe
            </p>

            <ngx-stripe-elements [stripe]="stripe" [elementsOptions]="elementsOptions"
                (elements)="onElementsChange($event)">
                <ngx-stripe-payment></ngx-stripe-payment>
            </ngx-stripe-elements>

            <div class="actions">
                <button class="btn-secondary" (click)="cancel()">Back</button>
                <button class="btn-primary" (click)="pay()" [disabled]="processing || !elementsOptions.clientSecret">
                    {{ processing ? 'Processing...' : 'Pay Now ' + (totalDue | currency) }}
                </button>
            </div>
        </div>

        <!-- If already paid or no fees -->
        <div class="paid-message" *ngIf="registration?.sectionStatus?.payment">
            <p>âœ… Payment Complete</p>
            <button class="btn-primary" (click)="cancel()">Return to Dashboard</button>
        </div>

    </div>